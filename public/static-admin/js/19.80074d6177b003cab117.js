(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{"6X06":function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return s}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"site-set-box"},[a("Card",{attrs:{header:"站点名称："}},[a("CardRow",{attrs:{description:"你的Discuz!Q 站点的名称"}},[a("el-input",{attrs:{placeholder:"站点名称"},model:{value:e.siteName,callback:function(t){e.siteName=t},expression:"siteName"}})],1)],1),e._v(" "),a("Card",{attrs:{header:"站点介绍："}},[a("CardRow",{attrs:{description:"你的Discuz!Q 站点的介绍"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:4},placeholder:"站点介绍"},model:{value:e.siteIntroduction,callback:function(t){e.siteIntroduction=t},expression:"siteIntroduction"}})],1)],1),e._v(" "),a("Card",{attrs:{header:"上传图片："}},[a("CardRow",{staticClass:"box"},[a("div",{staticClass:"avatar-box"},e._l(e.numberimg,(function(t,i){return a("div",{key:i,staticClass:"avatar-somer-box"},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"","http-request":function(t){e.uploaderLogo(t,i)},"show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload},on:{change:e.handleFile}},[t.imageUrl?a("div",{staticClass:"avatar"},[a("img",{staticClass:"avatar-LogoImage",style:{width:t.imgWidht+"px",height:t.imgHeight+"px"},attrs:{src:t.imageUrl,alt:t.text,title:t.text}})]):a("i",{staticClass:"el-icon-circle-plus-outline"}),e._v(" "),a("p",{staticClass:"avatar-logo"},[e._v(e._s(t.text))]),e._v(" "),a("p",{staticClass:"avatar-pm"},[e._v(e._s(t.textrule))]),e._v(" "),a("p",{staticClass:"avatar-pm"},[e._v("大小：小于5M")])]),e._v(" "),a("el-button",{staticClass:"avatar-btn",attrs:{type:"text"},on:{click:function(t){e.deleteImage(t,i)}}},[e._v("删除")])],1)})),0)])],1),e._v(" "),a("Card",{attrs:{header:"站长："}},[a("CardRow",{attrs:{description:"填写站长的用户id"}},[a("el-input",{attrs:{placeholder:"站长",type:"number"},model:{value:e.siteMasterId,callback:function(t){e.siteMasterId=t},expression:"siteMasterId"}})],1)],1),e._v(" "),a("Card",{staticClass:"card-radio-con",attrs:{header:"站点模式："}},[a("CardRow",{attrs:{description:"你的Discuz!Q 站点的运行模式"}},[a("el-radio",{attrs:{label:"1"},on:{change:function(t){return e.radioChange("public")}},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v("公开模式")]),e._v(" "),a("el-radio",{attrs:{label:"2",disabled:e.disabled},on:{change:function(t){return e.radioChange("pay")}},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v("付费模式")])],1)],1),e._v(" "),a("el-collapse-transition",[a("div",{directives:[{name:"show",rawName:"v-show",value:"2"===e.radio,expression:"radio === '2'"}]},[a("Card",{attrs:{header:"加入价格（元）："}},[a("CardRow",{attrs:{description:"付费模式下，付费成为站点默认角色，需支付的金额"}},[a("el-input",{attrs:{placeholder:"加入价格",type:"number"},model:{value:e.sitePrice,callback:function(t){e.sitePrice=t},expression:"sitePrice"}})],1)],1),e._v(" "),a("Card",{attrs:{header:"到期时间："}},[a("CardRow",{attrs:{description:"付费模式下，付费成为站点默认角色，可维持的时间，不填或为0时不限制"}},[e._v("\n          加入起\n          "),a("el-input",{staticStyle:{height:"36PX",width:"80PX"},attrs:{clearable:"",placeholder:"天数",type:"number"},model:{value:e.siteExpire,callback:function(t){e.siteExpire=t},expression:"siteExpire"}}),e._v("天后\n        ")],1)],1)],1)]),e._v(" "),a("Card",{attrs:{header:"金额分成比例："}},[a("CardRow",{attrs:{description:"主题打赏、付费等的分成比例设置，两者加起来必须为10，不填时默认为作者10、平台0"}},[a("div",{staticClass:"proportion-box"},[a("span",[e._v("作者")]),e._v(" "),a("el-input",{attrs:{size:"small",type:"number"},nativeOn:{"!blur":function(t){return e.onblurFun(t)}},model:{value:e.siteAuthorScale,callback:function(t){e.siteAuthorScale=t},expression:"siteAuthorScale"}})],1),e._v(" "),a("div",{staticClass:"proportion-box"},[a("span",[e._v("平台(站长)")]),e._v(" "),a("el-input",{attrs:{size:"small",type:"number"},nativeOn:{"!blur":function(t){return e.onblurFun(t)}},model:{value:e.siteMasterScale,callback:function(t){e.siteMasterScale=t},expression:"siteMasterScale"}})],1)])],1),e._v(" "),a("Card",{attrs:{header:"网站备案信息："}},[a("CardRow",{attrs:{description:"你的Discuz!Q 站点的 ICP 备案编号"}},[a("el-input",{model:{value:e.siteRecord,callback:function(t){e.siteRecord=t},expression:"siteRecord"}})],1)],1),e._v(" "),a("Card",{attrs:{header:"第三方统计："}},[a("CardRow",{attrs:{description:"你的Discuz!Q 网站的第三方统计代码（禁止使用含有document.write的统计代码）"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:4}},model:{value:e.siteStat,callback:function(t){e.siteStat=t},expression:"siteStat"}})],1)],1),e._v(" "),a("Card",{staticClass:"card-radio-con",attrs:{header:"关闭站点："}},[a("CardRow",{attrs:{description:"暂时将网站关闭，其他人无法访问，但不影响管理员访问"}},[a("el-radio",{attrs:{label:"1"},on:{change:function(t){return e.radioChangeClose("1")}},model:{value:e.radio2,callback:function(t){e.radio2=t},expression:"radio2"}},[e._v("是")]),e._v(" "),a("el-radio",{attrs:{label:"2"},on:{change:function(t){return e.radioChangeClose("2")}},model:{value:e.radio2,callback:function(t){e.radio2=t},expression:"radio2"}},[e._v("否")])],1)],1),e._v(" "),a("el-collapse-transition",[a("div",{directives:[{name:"show",rawName:"v-show",value:"1"===e.radio2,expression:"radio2 === '1'"}]},[a("Card",{attrs:{header:""}},[a("CardRow",{attrs:{description:"站点关闭时出现的提示信息"}},[a("el-input",{model:{value:e.siteCloseMsg,callback:function(t){e.siteCloseMsg=t},expression:"siteCloseMsg"}})],1)],1)],1)]),e._v(" "),a("Card",{staticClass:"footer-btn"},[a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.siteSetPost}},[e._v("提交")])],1)],1)},s=[]},Lomd:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(a("QbLZ"));a("lpfh");var s=r(a("vx/2"));function r(e){return e&&e.__esModule?e:{default:e}}t.default=(0,i.default)({name:"site-set-view"},s.default)},MtZS:function(e,t,a){},PUmH:function(e,t,a){"use strict";a.r(t);var i=a("6X06"),s=a("xoSE");for(var r in s)"default"!==r&&function(e){a.d(t,e,(function(){return s[e]}))}(r);a("z1HU");var o=a("KHd+"),n=Object(o.a)(s.default,i.a,i.b,!1,null,null,null);t.default=n.exports},"vx/2":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(a("4d7F")),s=o(a("4gYi")),r=o(a("pNQN"));function o(e){return e&&e.__esModule?e:{default:e}}t.default={data:function(){return{radio:"1",radio2:"2",loading:!0,fullscreenLoading:!1,siteName:"",siteIntroduction:"",siteMode:"1",sitePrice:"",siteExpire:"",siteAuthorScale:"",siteMasterScale:"",siteClose:"1",siteLogoFile:[],siteMasterId:"",siteRecord:"",siteStat:"",siteCloseMsg:"",dialogImageUrl:"",dialogVisible:!1,fileList:[],deleBtn:!1,disabled:!0,numberimg:[{imageUrl:"",imgWidht:0,imgHeight:0,text:"站点LOGO",textrule:"推荐高度：88px"},{imageUrl:"",imgWidht:0,imgHeight:0,text:"首页头部LOGO",textrule:"推荐高度：88px"},{imageUrl:"",imgWidht:0,imgHeight:0,text:"首页头部背景",textrule:"尺寸：750px*400px"},{imageUrl:"",imgWidht:0,imgHeight:0,text:"ICON",textrule:"尺寸：120px*120px"}]}},created:function(){this.loadStatus()},computed:{},methods:{loadStatus:function(){var e=this;this.appFetch({url:"forum",method:"get",data:{}}).then((function(t){t.errors?e.$message.error(t.errors[0].code):(e.siteName=t.readdata._data.set_site.site_name,e.siteIntroduction=t.readdata._data.set_site.site_introduction,e.siteMode=t.readdata._data.set_site.site_mode,e.numberimg[0].imageUrl=t.readdata._data.set_site.site_logo,e.numberimg[1].imageUrl=t.readdata._data.set_site.site_header_logo,e.numberimg[2].imageUrl=t.readdata._data.set_site.site_background_image,e.numberimg[3].imageUrl=t.readdata._data.set_site.site_favicon,e.getScaleImgSize(e.numberimg[0].imageUrl,{width:140,height:140}).then((function(t){e.numberimg[0].imgWidht=t.width,e.numberimg[0].imgHeight=t.height})),e.getScaleImgSize(e.numberimg[1].imageUrl,{width:140,height:140}).then((function(t){e.numberimg[1].imgWidht=t.width,e.numberimg[1].imgHeight=t.height})),e.getScaleImgSize(e.numberimg[2].imageUrl,{width:140,height:140}).then((function(t){e.numberimg[2].imgWidht=t.width,e.numberimg[2].imgHeight=t.height})),e.getScaleImgSize(e.numberimg[3].imageUrl,{width:140,height:140}).then((function(t){e.numberimg[3].imgWidht=t.width,e.numberimg[3].imgHeight=t.height})),"pay"==e.siteMode?e.radio="2":e.radio="1",e.sitePrice=t.readdata._data.set_site.site_price,e.siteExpire=t.readdata._data.set_site.site_expire,e.siteAuthorScale=t.readdata._data.set_site.site_author_scale,e.siteMasterScale=t.readdata._data.set_site.site_master_scale,e.siteRecord=t.readdata._data.set_site.site_record,e.siteStat=t.readdata._data.set_site.site_stat,e.siteClose=t.readdata._data.set_site.site_close,e.siteMasterId=t.readdata._data.set_site.site_author.id,1==e.siteClose?e.radio2="1":e.radio2="2",e.siteCloseMsg=t.readdata._data.set_site.site_close_msg,0==t.readdata._data.paycenter.wxpay_close?e.disabled=!0:e.disabled=!1)})).catch((function(e){}))},deleteImage:function(e,t,a){var i=this,s="";switch(t){case 0:s="logo";break;case 1:s="header_logo";break;case 2:s="background_image";break;case 3:s="favicon";break;default:this.$message.error("未知类型")}this.numberimg[t].imageUrl="",this.appFetch({url:"logo",method:"delete",data:{type:s}}).then((function(e){e.errors?i.$message.error(e.errors[0].code):i.$message("删除成功")})).catch((function(e){}))},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},radioChange:function(e){this.siteMode=e},radioChangeClose:function(e){this.siteClose="1"==e},handleAvatarSuccess:function(e,t){},handleFile:function(){},getScaleImgSize:function(e,t){var a=this;return new i.default((function(i,s){a.getImageSize(e).then((function(e){var a=e.height/e.width;a>t.height/t.width?i({width:t.height/a,height:t.height}):i({width:t.width,height:t.width*a})})).catch((function(e){s(e)}))}))},getImageSize:function(e){var t=document.createElement("img");return new i.default((function(a,i){t.onload=function(e){a({width:t.naturalWidth,height:t.naturalHeight})},t.src=e,t.onerror=i}))},beforeAvatarUpload:function(e){var t="image/jpeg"==e.type||"image/png"==e.type||"image/gif"==e.type||"image/ico"==e.type,a=e.size/1024/1024<2;return t?a?t&&a:(this.$message.warning("上传头像图片大小不能超过 2MB!"),a):(this.$message.warning("上传头像图片只能是 JPG/PNG/GIF/ICO 格式!"),t)},uploaderLogo:function(e,t){var a=this,i="";switch(t){case 0:i="logo";break;case 1:i="header_logo";break;case 2:i="background_image";break;case 3:i="favicon";break;default:this.$message.error("未知类型")}var s=new FormData;s.append("logo",e.file),s.append("type",i),this.appFetch({url:"logo",method:"post",data:s}).then((function(e){e.errors?a.$message.error(e.errors[0].code):(a.numberimg[t].imageUrl=e.readdata._data.default.logo,a.getScaleImgSize(a.numberimg[t].imageUrl,{width:120,height:120}).then((function(e){a.numberimg[t].imgWidht=e.width,a.numberimg[t].imgHeight=e.height})),a.$message({message:"上传成功",type:"success"}))})).catch((function(e){}))},errorFile:function(){},siteSetPost:function(){var e=this;this.appFetch({url:"settings",method:"post",data:{data:[{attributes:{key:"site_name",value:this.siteName?this.siteName:"",tag:"default"}},{attributes:{key:"site_introduction",value:this.siteIntroduction?this.siteIntroduction:"",tag:"default"}},{attributes:{key:"site_author",value:this.siteMasterId,tag:"default"}},{attributes:{key:"site_mode",value:this.siteMode,tag:"default"}},{attributes:{key:"site_price",value:this.sitePrice,tag:"default"}},{attributes:{key:"site_expire",value:this.siteExpire,tag:"default"}},{attributes:{key:"site_author_scale",value:this.siteAuthorScale,tag:"default"}},{attributes:{key:"site_master_scale",value:this.siteMasterScale,tag:"default"}},{attributes:{key:"site_record",value:this.siteRecord,tag:"default"}},{attributes:{key:"site_stat",value:this.siteStat,tag:"default"}},{attributes:{key:"site_close",value:this.siteClose,tag:"default"}},{attributes:{key:"site_close_msg",value:this.siteCloseMsg,tag:"default"}}]}}).then((function(t){t.errors?t.errors[0].detail?e.$message.error(t.errors[0].code+"\n"+t.errors[0].detail[0]):e.$message.error(t.errors[0].code):e.$message({message:"提交成功",type:"success"})})).catch((function(e){}))},onblurFun:function(){null!=this.siteAuthorScale&&""!=this.siteAuthorScale||(this.siteAuthorScale=0),null!=this.siteMasterScale&&""!=this.siteMasterScale||(this.siteMasterScale=0),10!=parseFloat(this.siteAuthorScale)+parseFloat(this.siteMasterScale)&&this.$message({message:"分成比例相加必须为10",type:"error"})}},components:{Card:s.default,CardRow:r.default}}},xoSE:function(e,t,a){"use strict";a.r(t);var i=a("Lomd"),s=a.n(i);for(var r in i)"default"!==r&&function(e){a.d(t,e,(function(){return i[e]}))}(r);t.default=s.a},z1HU:function(e,t,a){"use strict";var i=a("MtZS");a.n(i).a}}]);